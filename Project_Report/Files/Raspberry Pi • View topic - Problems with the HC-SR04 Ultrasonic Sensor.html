<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<meta charset="">
<meta name="viewport" content="width=device-width">


<title>Raspberry Pi • View topic - Problems with the HC-SR04 Ultrasonic Sensor</title>

<link rel="shortcut icon" href="https://www.raspberrypi.org/favicon.ico" type="image/vnd.microsoft.icon">
<link rel="icon" href="https://www.raspberrypi.org/favicon.ico" type="image/x-ico">
<link rel="profile" href="https://gmpg.org/xfn/11">

<link rel="stylesheet" type="text/css" media="all" href="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/style.css">
<link rel="stylesheet" type="text/css" href="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/custom.css">
<link rel="stylesheet" type="text/css" href="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/bootstrap-raspi.css">
<!--[if lt IE 8]>
<link rel="stylesheet" type="text/css" href="./styles/raspite/theme/css/ie7.css">
<![endif]-->
<link href="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/css.css" rel="stylesheet" type="text/css">
<!--[if lt IE 9]>
<script src="./styles/raspite/theme/js/html5shiv.js"></script>
<![endif]-->
<link rel="pingback" href="">

<link rel="alternate" type="application/atom+xml" title="Feed - Raspberry Pi" href="http://www.raspberrypi.org/forums/feed.php"><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="http://www.raspberrypi.org/forums/feed.php?mode=topics"><link rel="alternate" type="application/atom+xml" title="Feed - Forum - Automation, sensing and robotics" href="http://www.raspberrypi.org/forums/feed.php?f=37"><link rel="alternate" type="application/atom+xml" title="Feed - Topic - Problems with the HC-SR04 Ultrasonic Sensor" href="http://www.raspberrypi.org/forums/feed.php?f=37&amp;t=77534">


<script async="" src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/analytics.js"></script><script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/; domain=.raspberrypi.org';
	var onload_functions = new Array();
	var onunload_functions = new Array();

	

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	};

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	};

// ]]>
</script>
<link href="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/stylesheet.css" rel="stylesheet" type="text/css" media="screen, projection">



</head>

<body>
<a name="top"></a>

<header class="navbar navbar-fixed-top">
	<div class="navbar-inner">
		<!-- Cross-site Navigation -->

		<nav class="container" role="navigation">
			<h3 class="assistive-text">Main menu</h3>

			<div class="skip-link"><a class="assistive-text" href="#content" title="Skip to primary content">Skip to primary content</a></div>

		  <a href="#" class="btn btn-navbar pull-right" data-toggle="collapse" data-target=".nav-collapse">
            <i class="icon-bar"></i>
            <i class="icon-bar"></i>
            <i class="icon-bar"></i>
          </a>

			<div class="nav-collapse">
				<div class="nav pull-right">

					<ul id="menu-test-menu" class="nav">
						<li id="menu-item-1862" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1862"><a href="https://www.raspberrypi.org/quick-start-guide">Quick Start</a></li>
						<li id="menu-item-1864" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1864"><a href="https://www.raspberrypi.org/downloads">Downloads</a></li>
						<li id="menu-item-1870" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1870"><a href="https://www.raspberrypi.com/" onclick="javascript:_gaq.push(['_trackEvent','outbound-menu','//www.raspberrypi.com']);">Buy Codecs</a></li>
						<li id="menu-item-1867" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1867"><a href="https://www.raspberrypi.org/phpBB3">Forum</a></li>
						<li id="menu-item-1869" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1869"><a href="https://www.raspberrypi.org/faqs">FAQs</a></li>
						<li id="menu-item-1861" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1861 dropdown"><a href="#" data-toggle="dropdown" data-target="#" class="dropdown-toggle">About <span class="caret"></span></a>
							<ul class="dropdown-menu">
								<li id="menu-item-1865" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1865"><a href="https://www.raspberrypi.org/about">About us</a></li>
								<li id="menu-item-1866" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1866"><a href="https://www.raspberrypi.org/contact-us">Contact us</a></li>
								<li id="menu-item-4662" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4662"><a href="https://www.raspberrypi.org/technical-help-and-resource-documents">Technical, help and resource documents</a></li>
								<li id="menu-item-1863" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-1863"><a href="https://www.raspberrypi.org/trademark-rules">Trademark rules</a></li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
			<a class="nav-logo" href="https://www.raspberrypi.org/" title="Raspberry Pi" rel="home">Raspberry Pi</a>
		</nav>



	</div>
</header>

<div class="container">
	
	<div class="row-fluid searchbar">
		<div class="span6">
		<a href="https://www.raspberrypi.org/forums/faq.php?sid=ee50a51e0beefeb5b014bd86f88087bc" title="Frequently Asked Questions">FAQ</a>
		<a href="https://www.raspberrypi.org/forums/ucp.php?mode=register&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">Register</a>
			<a href="https://www.raspberrypi.org/forums/ucp.php?mode=login&amp;sid=ee50a51e0beefeb5b014bd86f88087bc" title="Login" accesskey="x">Login</a>
			
		</div>
		<div class="span6 text-right">
			
			<form action="./search.php?sid=ee50a51e0beefeb5b014bd86f88087bc" method="get" id="search" class="form-search" style="display:inline-block; *display:inline; zoom:1;">
				<input name="keywords" id="keywords" maxlength="128" title="Search for keywords" class="search-query input-small" value="Search…" onclick="if(this.value=='Search…')this.value='';" onblur="if(this.value=='')this.value='Search…';" type="text">
				<button class="btn" value="Search" type="submit" title="Search"><i class="icon icon-search"></i></button>
				<input name="sid" value="ee50a51e0beefeb5b014bd86f88087bc" type="hidden">

			</form>
		
		</div>
	</div>
	
</div>

<a name="content"></a>
<div class="container" role="main">

<div class="row-fluid">
	<div class="span9">
		<h2>Problems with the HC-SR04 Ultrasonic Sensor</h2>
		
		<!-- ICONS! -->
			
	</div>

</div>

<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->

<br>
<div class="row-fluid">
	<div class="topic-actions span8">
	
		<a href="https://www.raspberrypi.org/forums/posting.php?mode=reply&amp;f=37&amp;t=77534&amp;sid=ee50a51e0beefeb5b014bd86f88087bc" class="btn btn-info" title="Post a reply">Post a reply</a> 
	&nbsp;</div>
	
	
	<div class="paging span4 text-right">
		14 posts
		
	</div>
	
	
</div>
	<div id="p552559" class="post row-fluid even">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105631&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">SavagePi</a></strong> » Sun May 18, 2014 9:11 pm </div>

			

			<div class="content">Have you been having problems using the HC-SR04 Ultrasonic Distance Sensor?<br><br>So
 have I.  And after some intensive testing (you'll need a dual beam 
oscilloscope to see this properly), here's what I've discovered...  <br><br>It
 suffers from some inherent built-in flaws.  One of which is where the 
receiver picks up the signal from the transmitter before the sound has 
even 'bounced off' any object at all.  Try putting a small tube about 
20cm long over either the transmitter or receiver (it doesn't matter 
which one) to see how this overcomes the problem.  <br><br>The worst 
problem of all is when the sound waves are reflected off objects that 
are at oblique angles, and this is particularly worse if they're at some
 distance away.  This results in the most erratic 'Echo' signals 
imaginable.  This could mean your program seems to 'lock up' if you use 
the 'conventional' way of interfacing to this device.  In fact, I 
understand lots of people have given trying to use the HC-SR04 because 
they think it's so unreliable.<br><br>However, here's a program I've 
written for my Pi Car, which uses the HC-SR04 as the distance sensor.  
Check out the 'get_distance' function to see how I've overcome all the 
problems with the sensor.  <br><br>I hope this program is helpful to all you robotics fans out there.  Please feel free to comment.<br><br><dl class="codebox"><dt>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></dt><dd><code># *******************************************************************<br># * DUAL MOTOR DRIVER USING A Wii REMOTE CONTROL AND THE GPIO BUS&nbsp; &nbsp;*<br># *******************************************************************<br># * This program is designed to control the L298N Dual Full Bridge&nbsp; *<br># * Driver IC, which in turn drives two DC motors.&nbsp; These could be&nbsp; *<br># * the left and right hand wheels of a small motorised vehicle.&nbsp; &nbsp; *<br># * The L298N has 6 control signals: In1, In2, In3, In4, EnA &amp; EnB. *<br># * All of the signals are active high.&nbsp; See the manufacturers data *<br># * sheet for full details of the L298N device.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;*<br># * Run the program from a Terminal window (root user).&nbsp; It will&nbsp; &nbsp; *<br>#
 * not run from within the Python Shell GUI.&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># *&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;*<br># * List of the GPIO pins used:&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># * GPIO25 - Motor 1 (left motor) Enable - EnA - (output - bit 0)&nbsp; &nbsp;*<br># * GPIO24 - Motor 1 (left motor) Forward - In1 -(output - bit 1)&nbsp; &nbsp;*<br># * GPIO23 - Motor 1 (left motor) Reverse - In2 -(output - bit 2)&nbsp; &nbsp;*<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;*<br># * GPIO22 - Motor 2 (right motor) Enable - EnB - (output - bit 3)&nbsp; *<br># * GPIO27 - Motor 2 (right motor) Forward - In3 - (output - bit 4) *<br># * GPIO18 - Motor 2 (right motor) Reverse - In4 - (output - bit 5) *<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;*<br># * GPIO17 - Trigger for the ultrasonic sensor (output - bit 6)&nbsp; &nbsp; &nbsp;*<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;*<br># * GPIO11 - Spare GPIO output pin (output - bit 7)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;*<br># * GPIO10 - Echo input from the ultrasonic sensor (input - bit 8)&nbsp; *<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;*<br># * GPIO9&nbsp; - Spare GPIO Input pin (input - bit 9)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># * GPIO8&nbsp; - Spare GPIO Input pin (input - bit 10)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *<br># * GPIO7&nbsp; - Spare GPIO Input pin (input - bit 11)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *<br># *******************************************************************<br><br>import
 RPi.GPIO as GPIO&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Import the GPIO module
 as 'GPIO'<br><br>import cwiid&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # Import the Nintendo Wii controller module<br><br>import
 time&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Import the 'time' module<br><br>import random<br><br>GPIO.setmode
 (GPIO.BCM)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Set the GPIO mode to 
BCM numbering<br><br><br># *******************************************************************<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;DEFINE THE CONSTANTS&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *<br># *******************************************************************<br># *&nbsp; IMPORTANT: For a Rev 1 RPi, replace 27 below with 21 instead&nbsp; &nbsp;*<br># *******************************************************************<br><br>output_ports
 = [25, 24, 23, 22, 27, 18, 17, 11]&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Define the GPIO
 output port numbers<br>input_ports = [10, 9, 8, 7]&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Define the GPIO input port numbers<br><br>m1_en = 1&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Motor 1 
Enable (left motor)<br>m1_fwd = 2&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Motor 1 Forward (left motor)<br>m1_rev
 = 4&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # Motor 1 Reverse (left motor)<br>m2_en = 8&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Motor 2 Enable (right motor)<br>m2_fwd = 16&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Motor 2 Forward (right
 motor)<br>m2_rev = 32&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp;# Motor 2 Reverse (right motor)<br>trig = 
17&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Trigger output for the ultrasonic sensor<br>echo = 
10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Echo return from the ultrasonic sensor<br><br>stop = 
0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # Drive value for no movement<br>left = m1_en + m1_rev + 
m2_en + m2_fwd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Drive 
value for turning left<br>right = m1_en + m1_fwd + m2_en + m2_rev&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Drive value for turning right<br>fwd
 = m1_en + m1_fwd + m2_en + m2_fwd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;# Drive value for moving forwards<br>rev = m1_en + 
m1_rev + m2_en + m2_rev&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;# Drive value for moving backwards<br>auto = -1&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Drive value for automatic mode<br><br><br># *******************************************************************<br># *&nbsp; &nbsp; &nbsp; FUNCTION TO DRIVE THE MOTORS USING THE SUPPLIED VALUE&nbsp; &nbsp; &nbsp; *<br># *******************************************************************<br># * Although the 'global' command is used, this is simply to allow&nbsp; *<br># * access to the program variables outside the function.&nbsp; These&nbsp; &nbsp; *<br># * are never altered by any function throughout the entire program *<br># * On exit, 'b' contains a 12-bit binary string representing the&nbsp; &nbsp;*<br># * states of the 12 GPIO pins - all eight outputs - 0 to 7 and all *<br>#
 * four inputs - 8 to 11&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># *******************************************************************<br><br>def
 motor_drive (value):&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Accept the motor 
drive value<br>&nbsp; &nbsp; global input_ports, output_ports&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Allow acces to the 
assigned GPIO ports<br>&nbsp; &nbsp; b = bin (value)&nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp;# Create a binary string from the supplied 
value<br>&nbsp; &nbsp; b = b [2:len(b)]&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # Strip off the '0b' from the start of the string<br>&nbsp;
 &nbsp; b = b.zfill(8)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 
Make sure the string is eight bits long<br><br>&nbsp; &nbsp; 
output_pointer = len (b) -1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Start with the LSB of Binary string<br>&nbsp;
 &nbsp; for port in output_ports:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Pick out the 
individual GPIO port required<br>&nbsp; &nbsp; &nbsp; &nbsp; 
output_state = int (b[output_pointer])&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Select 
whether it needs to be on or off (1 or 0)<br>&nbsp; &nbsp; &nbsp; &nbsp;
 GPIO.output (port,output_state)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Turn on or off the relevant GPIO bit<br>&nbsp; &nbsp; 
&nbsp; &nbsp; output_pointer = output_pointer - 1&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Move to the next bit in the string<br>&nbsp; &nbsp; for 
port in input_ports:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Get the status of the four input 
bits<br>&nbsp; &nbsp; &nbsp; &nbsp; b = str (GPIO.input (port)) + 
b&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Add the bit values to 
the Binary string<br>&nbsp; &nbsp; return (b)&nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Exit with the Binary string in 'b'<br><br><br># *******************************************************************<br># *&nbsp; &nbsp;FUNCTION TO REVERSE THE CAR TO AVOID OBJECTS IN FRONT OF IT&nbsp; &nbsp;*<br># *******************************************************************<br># * If an obstruction is detected in front of the car which is less *<br># * than 15cm away, then back away from it to a distance of 20cm.&nbsp; &nbsp;*<br># * This happens irrespective of whether the car is being driven&nbsp; &nbsp; *<br># * manually or autonomously.&nbsp; To prevent excess current surges and *<br># * sudden 'unnatural' reversing, stop the car first, then wait for *<br>#
 * half a second before and after backing up&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># *******************************************************************<br><br>def back_away (direction):<br>&nbsp;
 &nbsp; movement = motor_drive (False)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # First of all, stop the car<br>&nbsp; 
&nbsp; time.sleep (0.5)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Wait 
for half a second<br>&nbsp; &nbsp; distance = get_distance()&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;# Get the current object distance<br>&nbsp; &nbsp; while distance 
&lt; 20:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Whilst it's less than 20cm <br>&nbsp;
 &nbsp; &nbsp; &nbsp; movement = motor_drive (direction)&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # keep reversing the car<br>&nbsp; &nbsp; &nbsp; 
&nbsp; distance = get_distance ()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # and checking the distance<br>&nbsp; &nbsp;
 movement = motor_drive (False)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # Otherwise, stop the car,<br>&nbsp; &nbsp; 
time.sleep (0.5)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # wait for half a
 second,<br>&nbsp; &nbsp; return (False)&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # then exit with no direction (stop)<br><br><br># *******************************************************************<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FUNCTION TO DRIVE THE
 CAR AUTONOMOUSLY&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># *******************************************************************<br># * This function is called if the 'A' button, and ONLY the 'A'&nbsp; &nbsp; &nbsp;*<br># * button on the Wii Remote Control is being held down.&nbsp; The car&nbsp; &nbsp;*<br># * will normally attempt to drive forwards.&nbsp; If an obstruction is&nbsp; *<br># * detected in front of it then the 'back_away' function is called.*<br># * The car will then turn either left or right - depending on a&nbsp; &nbsp; *<br># * random number between 0 and 7.&nbsp; Between 0 and 3 the the car&nbsp; &nbsp; &nbsp;*<br># * will turn left.&nbsp; Between 4 and 7 and the car will turn right.&nbsp; &nbsp;*<br># * It will then attempt to continue in a forwards direction&nbsp; &nbsp; &nbsp; &nbsp; *<br># *******************************************************************<br><br>def automatic (buttons):<br>&nbsp;
 &nbsp; global stop, left, right, fwd, rev&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # Allow access to the direction constants<br><br>&nbsp;
 &nbsp; while (buttons - cwiid.BTN_A == 0):&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;# Run autonomously only while 'A' pressed<br>&nbsp; 
&nbsp; &nbsp; &nbsp; direction = fwd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Set the initial direction to forwards<br>&nbsp; &nbsp; &nbsp; &nbsp; 
distance = get_distance ()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # Check the distance<br>&nbsp; &nbsp; &nbsp; &nbsp;
 if direction == fwd and distance &lt; 15:&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If the 
distance is less than 15cm then<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; movement = back_away (rev)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # reverse the car if driving forward<br>&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; direction = right&nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Set initial 
turn direction to 'right'<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
turn = random.randint (0,7)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;# Generate a random number between 0 and 7<br>&nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; if turn &lt; 4:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If the 
random number is less than 4<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; direction = left&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # then turn left instead<br>&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movement = motor_drive 
(direction)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Now turn in that direction<br>&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep (0.5)&nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # for 
half a second<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; movement = 
motor_drive (stop)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Then 
stop for half a second<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; time.sleep (0.5)<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp;
 &nbsp; &nbsp; &nbsp; movement = motor_drive (direction)&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # Continue moving in a forwards direction<br>&nbsp;
 &nbsp; &nbsp; &nbsp; buttons = wii.state['buttons']&nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # Get the button data from the Wii remote<br><br>&nbsp;
 &nbsp; return ()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Exit if the 'A' button isn't being pressed<br>&nbsp; &nbsp; <br><br># *******************************************************************<br># *&nbsp; FUNCTION TO CALCULATE THE DISTANCE FROM OBSTRUCTIONS IN FRONT&nbsp; *<br># *******************************************************************<br># *&nbsp; &nbsp; &nbsp; &nbsp; THIS USES THE HC-SR04 ULTRASONIC DISTANCE SENSOR&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># *******************************************************************<br># * Unfortunately, the HC-SR04 suffers from some inherent built-in&nbsp; *<br># * flaws, particularly if the reflected sound waves bounce off&nbsp; &nbsp; &nbsp;*<br># * objects at a distance and/or at oblique angles.&nbsp; This results&nbsp; &nbsp;*<br># * in very erratic signals being generated on the 'Echo' pin.&nbsp; &nbsp; &nbsp; *<br># * Since we're only interested in short distances up to 20cm, we&nbsp; &nbsp;*<br># * need to trap these errors within this function, otherwise the&nbsp; &nbsp;*<br># * program would be very slow to respond to the Wii Remote buttons.*<br># * In worst-case situations the program could simply 'hang' whilst *<br># * waiting for an echo signal which never ends!&nbsp; On exit, if a&nbsp; &nbsp; &nbsp;*<br># * valid short distance is calculated, then 'distance' contains&nbsp; &nbsp; *<br># * the value in centimetres.&nbsp; If a sensor error occurs, then a&nbsp; &nbsp; &nbsp;*<br>#
 * value of 100 is returned instead.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;*<br># *******************************************************************<br><br>def get_distance ():<br>&nbsp;
 &nbsp; global trig, echo&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Allow access to 'trig' and 'echo' constants<br><br>&nbsp; &nbsp; if 
GPIO.input (echo):&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# If the 'Echo' pin is 
already high<br>&nbsp; &nbsp; &nbsp; &nbsp; return (100)&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # then exit with 100 (sensor fault)<br><br>&nbsp;
 &nbsp; distance = 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; # Set initial distance to zero<br><br>&nbsp; &nbsp; GPIO.output 
(trig,False)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # Ensure the 'Trig' pin is low for at<br>&nbsp;
 &nbsp; time.sleep (0.05)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
least 50mS (recommended re-sample time)<br><br>&nbsp; &nbsp; GPIO.output
 (trig,True)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Turn on the 'Trig' pin for 10uS 
(ish!)<br>&nbsp; &nbsp; dummy_variable = 0&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; # No need to use the 'time' module here,<br>&nbsp; &nbsp; 
dummy_variable = 0&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # a couple of 
'dummy' statements will do fine<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; 
GPIO.output (trig,False)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Turn off the 'Trig' pin<br>&nbsp; 
&nbsp; time1, time2 = time.time(), time.time()&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Set inital time values to current time<br>&nbsp; &nbsp; <br>&nbsp;
 &nbsp; while not GPIO.input (echo):&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Wait for the start of the 'Echo' 
pulse<br>&nbsp; &nbsp; &nbsp; &nbsp; time1 = time.time()&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;# Get the time the 'Echo' pin goes high<br>&nbsp; &nbsp; &nbsp; 
&nbsp; if time1 - time2 &gt; 0.02:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If the 'Echo' pin doesn't go high 
after 20mS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; distance = 
100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # then set 'distance' to 100<br>&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; break&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp;# and break out of the loop<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp;
 &nbsp; if distance == 100:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# If a 
sensor error has occurred<br>&nbsp; &nbsp; &nbsp; &nbsp; return 
(distance)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# then exit with 100 (sensor fault)<br>&nbsp; &nbsp; <br>&nbsp;
 &nbsp; while GPIO.input (echo):&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Otherwise, wait for 
the 'Echo' pin to go low<br>&nbsp; &nbsp; &nbsp; &nbsp; time2 = 
time.time()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Get the time the 'Echo' pin goes low<br>&nbsp;
 &nbsp; &nbsp; &nbsp; if time2 - time1 &gt; 0.02:&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If the 'Echo' pin 
doesn't go low after 20mS<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
distance = 100&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # then ignore it and set 'distance' 
to 100<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# and break out of the loop<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp;
 &nbsp; if distance == 100:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# If a 
sensor error has occurred<br>&nbsp; &nbsp; &nbsp; &nbsp; return 
(distance)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# then exit with 100 (sensor fault)<br>&nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Sound travels at approximately 
2.95uS per mm<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # and the 
reflected sound has travelled twice<br>&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # the distance we need to measure (sound out,<br>&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # bounced off object, sound returned)<br>&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br>&nbsp; &nbsp; distance = (time2 -
 time1) / 0.00000295 / 2 / 10&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # Convert the timer values into centimetres<br>&nbsp;
 &nbsp; return (distance)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Exit with the distance in centimetres<br>&nbsp; &nbsp; <br><br># *******************************************************************<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; FUNCTION TO EXIT THE 
PROGRAM CLEANLY&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># *******************************************************************<br># * Use this function to turn off both motor and to ensure the GPIO *<br># * ports are reset properly on exit, or if a controllable error&nbsp; &nbsp; *<br># * occurs within the program.&nbsp; Note: This will not work if CTRL-C&nbsp; *<br># * is used to quit the program prematurely.&nbsp; In such case, a GPIO&nbsp; *<br># * error message will be displayed when the program is run again.&nbsp; *<br># * However, the program will continue to function as normal&nbsp; &nbsp; &nbsp; &nbsp; *<br># *******************************************************************<br><br>def exit_program():<br>&nbsp;
 &nbsp; z = motor_drive (False)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Turn off all the GPIO 
outputs<br>&nbsp; &nbsp; print ("\n\n")&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # Print a couple of blank lines<br>&nbsp; &nbsp; 
GPIO.cleanup()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Clean 
up the GPIO ports<br>&nbsp; &nbsp; exit()&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # And quit the program<br><br><br># *******************************************************************<br>#
 *&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
START OF THE MAIN PROGRAM&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; *<br># *******************************************************************<br><br>for
 bit in output_ports:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Set up the six output
 bits<br>&nbsp; &nbsp; GPIO.setup (bit,GPIO.OUT)<br>&nbsp; &nbsp; 
GPIO.output (bit,False)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Initially turn them all off<br>&nbsp; &nbsp; <br>for
 bit in input_ports:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Set up the six 
input bits<br>&nbsp; &nbsp; GPIO.setup (bit,GPIO.IN, pull_up_down = 
GPIO.PUD_DOWN)&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Set the
 inputs as normally low<br>&nbsp; &nbsp; <br><br># *******************************************************************<br># * CONNECT TO THE Wii REMOTE CONTROL. QUIT IF IT TIMES OUT 3 TRIES *<br># *******************************************************************<br># * The Wii Remote Control is connected via a bluetooth adaptor and *<br># * by importing the 'cwiid' module.&nbsp; To connect, press and release *<br># * the '1' and '2' buttons simultaneously on the Wii Remote.&nbsp; The&nbsp; *<br># * program will try to connect up to 3 times.&nbsp; If it fails the&nbsp; &nbsp; &nbsp;*<br>#
 * program will terminate&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; *<br># *******************************************************************<br><br>print ("\n\n\n\nPress 1 &amp; 2 together on your Wii Remote now ...")&nbsp; &nbsp; &nbsp; &nbsp;# Print some instructions<br><br>attempt
 = ['first', 'second', 'last']&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Make them a bit informative<br>word = 0&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 
Number of attempts to connect<br>while True:&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Start an infinite loop<br>&nbsp; &nbsp; try:<br>&nbsp; &nbsp; &nbsp; &nbsp; print ("\n\nTrying to connect for the"), attempt [word],<br>&nbsp;
 &nbsp; &nbsp; &nbsp; print ("time...\n\nAttempt"), word+1&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # Print current attempt<br>&nbsp; &nbsp; <br>&nbsp; &nbsp;
 &nbsp; &nbsp; wii=cwiid.Wiimote()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Wait for a 
response from the Wii remote<br>&nbsp; &nbsp; &nbsp; &nbsp; break&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# If 
successful then exit the loop<br><br>&nbsp; &nbsp; except 
RuntimeError:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # If it times out...<br>&nbsp;
 &nbsp; &nbsp; &nbsp; word = word + 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Try again<br>&nbsp; &nbsp; &nbsp; &nbsp; if word == 3:&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp;# If it fails after 3 attempts...<br>&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print ("\n\nFailed to connect to the 
Wii remote control")&nbsp; &nbsp;# Print a failure message<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print ("\nProgram Terminated\n")<br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; print ("Please restart the program to begin again\n\n")<br><br>&nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; terminate = exit_program()&nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # And exit the program<br><br><br># *******************************************************************<br># *&nbsp; &nbsp; &nbsp; &nbsp; SUCCESSFULLY CONNECTED TO THE Wii REMOTE CONTROL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*<br># *******************************************************************<br><br>wii.rumble
 = 1&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 
Briefly vibrate the Wii remote<br>time.sleep(0.2)<br>wii.rumble = 0<br>wii.rpt_mode
 = cwiid.RPT_BTN | cwiid.RPT_ACC&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Report 
button and accelerometer data<br><br>print ("\n\n\n\nThe Wii Remote is 
now connected...\n")&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # Print a few instructions<br>print ("Use the direction pad to steer the car\n")<br>print ("or...\n")<br>print ("Hold the 'B' button and tilt the Wii Remote to steer\n")<br>print ("or...\n")<br>print ("Press and hold down the 'A' button for Autonomous Mode\n")<br>print ("Press '+' and '-' buttons at the same time quit.\n")<br><br>while
 True:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp;# Begin an infinite loop<br>&nbsp; &nbsp; direction = 
stop&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Set the initial 
direction to none (stop)<br>&nbsp; &nbsp; buttons = 
wii.state['buttons']&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # Get the button data from the Wii remote<br>&nbsp; &nbsp;
 x, y, z = wii.state['acc']&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Also get the accelerometer data<br>&nbsp;
 &nbsp; if not (buttons &amp; cwiid.BTN_B):&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Only use accelerometer data if<br>&nbsp;
 &nbsp; &nbsp; &nbsp; x, y, z = 125, 125, 125&nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# the 'B' button is 
being pressed<br><br>&nbsp; &nbsp; if (buttons - cwiid.BTN_PLUS - 
cwiid.BTN_MINUS == 0):&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp;# Are both the '+' and '-' buttons pressed?<br>&nbsp; &nbsp; &nbsp; &nbsp; print ("\nThe Wii Remote connection has been closed\n")<br>&nbsp;
 &nbsp; &nbsp; &nbsp; print ("Please restart the program to begin 
again\n")&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# Yes - Print a 
message<br>&nbsp; &nbsp; &nbsp; &nbsp; wii.rumble = 1&nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # Briefly vibrate the Wii remote<br>&nbsp; &nbsp; &nbsp; &nbsp; time.sleep(0.2)<br>&nbsp; &nbsp; &nbsp; &nbsp; wii.rumble = 0<br>&nbsp;
 &nbsp; &nbsp; &nbsp; terminate = exit_program()&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # And quit the program<br><br>&nbsp;
 &nbsp; if (buttons - cwiid.BTN_A == 0):&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # If ONLY the 'A' button is pressed<br>&nbsp;
 &nbsp; &nbsp; &nbsp; movement = automatic (buttons)&nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; # then run autonomously<br><br># *******************************************************************<br># * Using the data from the Wii Remote Control, check which buttons *<br># * are pressed using a bitwise AND of the buttons bit value and&nbsp; &nbsp; *<br># * the predefined 'cwiid' constant for each button.&nbsp; If more than&nbsp; *<br># * one button is pressed, only the last one in the sequence 'left',*<br># * 'right', 'up' or 'down' will be selected.&nbsp; It has to be done&nbsp; &nbsp; *<br># * this way because the L298N controller cannot drive the motors&nbsp; &nbsp;*<br># * in two directions at the same time - eg: forwards and left&nbsp; &nbsp; &nbsp; *<br># *******************************************************************<br><br>&nbsp; &nbsp; if (buttons &amp; cwiid.BTN_LEFT) or x &lt; 110:<br>&nbsp;
 &nbsp; &nbsp; &nbsp; direction = left&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
 &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # Prepare
 to turn the car to the left<br><br>&nbsp; &nbsp; if(buttons &amp; cwiid.BTN_RIGHT) or x &gt; 130:<br>&nbsp;
 &nbsp; &nbsp; &nbsp; direction = right&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Prepare to turn the car to the right<br><br>&nbsp; &nbsp; if (buttons &amp; cwiid.BTN_UP) or y &gt; 130:<br>&nbsp;
 &nbsp; &nbsp; &nbsp; direction = fwd&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Prepare to drive the car forwards<br>&nbsp; &nbsp; <br>&nbsp; &nbsp; if (buttons &amp; cwiid.BTN_DOWN) or y &lt; 110:<br>&nbsp;
 &nbsp; &nbsp; &nbsp; direction = rev&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# 
Prepare to drive the car backwards<br><br>&nbsp; &nbsp; distance = 
get_distance ()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # Get object distance in centimetres<br><br>&nbsp; 
&nbsp; if direction == fwd and distance &lt; 15:&nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; # If the distance is less than 15cm then<br>&nbsp; &nbsp; 
&nbsp; &nbsp; direction = back_away (rev)&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;# reverse the car if driving forward<br><br>&nbsp;
 &nbsp; movement = motor_drive (direction)&nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 
&nbsp; &nbsp; &nbsp; # Otherwise get the car moving (if needs be)<br><br><br></code></dd></dl></div>

			<div id="sig552559" class="signature"><span style="color: #4040FF"><span style="font-size: 85%; line-height: 116%;">Electronics...  It's what I do!</span></span></div>

		</div>

		
		<dl class="postprofile span3" id="profile552559">
			<dt>
				<a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105631&amp;sid=ee50a51e0beefeb5b014bd86f88087bc"><img src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/file_002.php" alt="User avatar" width="88" height="85"></a><br>
				
			</dt>
		<dd><strong>Posts:</strong> 42</dd><dd><strong>Joined:</strong> Mon Mar 31, 2014 7:34 pm</dd><dd><strong>Location:</strong> Staffordshire, England</dd>

		</dl>
	

	
	</div>


	<div id="p552703" class="post row-fluid odd">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105275&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">BMS Doug</a></strong> » Mon May 19, 2014 7:49 am </div>

			

			<div class="content">Its designed for 5v not 3v3, if you have it 
connected to 3v3 then try upping that to 5v (but add a voltage divider 
to the echo pin to protect your GPIO).<br>(See <a href="http://www.raspberrypi.org/forums/viewtopic.php?f=37&amp;t=18291&amp;start=25" class="postlink">Joan's graph</a>, 3rd post on the 2nd page of this thread).<br><br><blockquote><div><cite>joan wrote:</cite>I
 wasn't happy with the results so plugged the unit into the 5V supply 
rather than 3V3.  I didn't bother trying to convert the (nominally) 5V 
echo pin to 3V3 for the Pi.  If you are of a nervous disposition add a 
couple of resistors as a voltage divisor for the echo pin before using 
the unit powered at 5V.  I'd probably do that if I planned to use the 
unit on the Pi as a permanent fixture.<br><br>Quite a difference when pointed at the same wall!<br><br>3V3<br>follow link above to see Graph (scattered signals)<br><br>5V<br>follow link above to see Graph (steady line)<br><br>Each graph is of 400 readings taken at about 10Hz.<br><br>I think the moral is the unit needs a 5V supply.</div></blockquote></div>

			<div id="sig552703" class="signature">Doug.<br>Building Management Systems Engineer.</div>

		</div>

		
		<dl class="postprofile span3" id="profile552703">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 3589</dd><dd><strong>Joined:</strong> Thu Mar 27, 2014 2:42 pm</dd><dd><strong>Location:</strong> London, UK</dd>

		</dl>
	

	
	</div>


	<div id="p552766" class="post row-fluid even">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=11888&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">simplesi</a></strong> » Mon May 19, 2014 10:27 am </div>

			

			<div class="content">In my Ultrasonic code, I take 3 readings, sort them and then return the middle value as my attempt to discard errored readings.<br><br>Like the idea of using tubes - will try that out<br>Simon</div>

			<div id="sig552766" class="signature">Seeking help with Scratch and I/O stuff for Primary age children <br>http://cymplecy.wordpress.com/ @cymplecy on twitter</div>

		</div>

		
		<dl class="postprofile span3" id="profile552766">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 2327</dd><dd><strong>Joined:</strong> Fri Feb 24, 2012 6:19 pm</dd><dd><strong>Location:</strong> Euxton, Lancashire, UK</dd>
			<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="http://cymplecy.wordpress.com/" title="WWW: http://cymplecy.wordpress.com/" class="btn btn-mini"><i class="icon icon-globe"></i></a></li>
				</ul>
			</dd>
		

		</dl>
	

	
	</div>


	<div id="p552981" class="post row-fluid odd">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105631&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">SavagePi</a></strong> » Mon May 19, 2014 4:39 pm </div>

			

			<div class="content">Sorry, I didn't clarify my connections.  The 
sensor is connected to the +5V supply and I have a 4K7 resistor in 
series with the 'echo' pin and the GPIO port on the RPi.  This limits 
the current to a safe level for the GPIO ports.  There's no need for a 
potential divider at small voltage differences such as these.  <br><br>However,
 when I was testing the sensor with the oscilloscope, I didn't actually 
have the 'echo' pin connected to the RPi.  This ensured it wasn't being 
influenced by any GPIO activity.  All I did was write a simple program 
to send out a 10uS (ish) pulse to the 'trig' pin every 70mS.  <br><br>Hope this clears things up a bit .</div>

			<div id="sig552981" class="signature"><span style="color: #4040FF"><span style="font-size: 85%; line-height: 116%;">Electronics...  It's what I do!</span></span></div>

		</div>

		
		<dl class="postprofile span3" id="profile552981">
			<dt>
				<a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105631&amp;sid=ee50a51e0beefeb5b014bd86f88087bc"><img src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/file_002.php" alt="User avatar" width="88" height="85"></a><br>
				
			</dt>
		<dd><strong>Posts:</strong> 42</dd><dd><strong>Joined:</strong> Mon Mar 31, 2014 7:34 pm</dd><dd><strong>Location:</strong> Staffordshire, England</dd>

		</dl>
	

	
	</div>


	<div id="p553158" class="post row-fluid even">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105275&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">BMS Doug</a></strong> » Mon May 19, 2014 9:40 pm </div>

			

			<div class="content">It's odd, I haven't seen that kind of scatter on
 the return of my HC-SR04  and Joan's graphs show that she didn't either
 (on a large sample size).</div>

			<div id="sig553158" class="signature">Doug.<br>Building Management Systems Engineer.</div>

		</div>

		
		<dl class="postprofile span3" id="profile553158">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 3589</dd><dd><strong>Joined:</strong> Thu Mar 27, 2014 2:42 pm</dd><dd><strong>Location:</strong> London, UK</dd>

		</dl>
	

	
	</div>


	<div id="p553649" class="post row-fluid odd">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105631&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">SavagePi</a></strong> » Tue May 20, 2014 6:37 pm </div>

			

			<div class="content"><blockquote><div><cite>BMS Doug wrote:</cite>It's
 odd, I haven't seen that kind of scatter on the return of my HC-SR04  
and Joan's graphs show that she didn't either (on a large sample size).</div></blockquote><br><br>Joan's
 graphs are perfect, Doug, and she's made an excellent effort in 
performing and describing her experiments.  My findings are almost 
exactly the same using an oscilloscope - although I'm working on the 
principle that sound travels at about 2.95uS per millimetre (not 
centimetre).  <br><br>The HC-SR04 works just fine if you point it at a 
large enough object (a wall, for example) that is almost parallel to the
 sensor, even up to 3 metres away with no obstructions in the way.  
However, if you alter the angle of the sensor by (say) 30 degrees, the 
sound will then bounce off the same wall at an oblique angle and head 
off in a different direction until it manages to bounce off another 
surface (window, door, alcove, chair, setee, cupboard, floor, ceiling, 
etc.) which is relatively perpendicular to the receiver.  <br><br>Even 
at close range (say, 30cm) using a sheet of cardboard.  If you tilt the 
angle of the cardboard sufficiently, the sound will again bounce off at a
 tangent and only be detected when it returns from another surface that 
the receiver is in line with. <br><br>Is any of this this making any sense?  <br><br>I'll have to put a video on YouTube to demonstrate it  <img src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/icon_e_wink.gif" alt=";)" title="Wink"></div>

			<div id="sig553649" class="signature"><span style="color: #4040FF"><span style="font-size: 85%; line-height: 116%;">Electronics...  It's what I do!</span></span></div>

		</div>

		
		<dl class="postprofile span3" id="profile553649">
			<dt>
				<a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105631&amp;sid=ee50a51e0beefeb5b014bd86f88087bc"><img src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/file_002.php" alt="User avatar" width="88" height="85"></a><br>
				
			</dt>
		<dd><strong>Posts:</strong> 42</dd><dd><strong>Joined:</strong> Mon Mar 31, 2014 7:34 pm</dd><dd><strong>Location:</strong> Staffordshire, England</dd>

		</dl>
	

	
	</div>


	<div id="p553749" class="post row-fluid even">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105275&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">BMS Doug</a></strong> » Tue May 20, 2014 9:08 pm </div>

			

			<div class="content">No that's fine, angled surface gives bad signals, makes perfect sense.<br><br>You are getting a few returns from the angled surface then?<br><br>That's good news, I'll probably use it in my project when I get it all together. <br>Perhaps
 I'll look into programming a routine that orientates the robot until it
 is completely facing the wall. (By turning until the returns stop 
scattering, then turning more until they scatter again).</div>

			<div id="sig553749" class="signature">Doug.<br>Building Management Systems Engineer.</div>

		</div>

		
		<dl class="postprofile span3" id="profile553749">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 3589</dd><dd><strong>Joined:</strong> Thu Mar 27, 2014 2:42 pm</dd><dd><strong>Location:</strong> London, UK</dd>

		</dl>
	

	
	</div>


	<div id="p553770" class="post row-fluid odd">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=11888&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">simplesi</a></strong> » Tue May 20, 2014 9:49 pm </div>

			

			<div class="content"><blockquote class="uncited"><div>Perhaps I'll 
look into programming a routine that orientates the robot until it is 
completely facing the wall. (By turning until the returns stop 
scattering, then turning more until they scatter again).</div></blockquote><br><br>Now that sounds like an interesting investigation - I like the initial philosophy <img src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/icon_e_smile.gif" alt=":)" title="Smile"><br><br>Simon</div>

			<div id="sig553770" class="signature">Seeking help with Scratch and I/O stuff for Primary age children <br>http://cymplecy.wordpress.com/ @cymplecy on twitter</div>

		</div>

		
		<dl class="postprofile span3" id="profile553770">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 2327</dd><dd><strong>Joined:</strong> Fri Feb 24, 2012 6:19 pm</dd><dd><strong>Location:</strong> Euxton, Lancashire, UK</dd>
			<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="http://cymplecy.wordpress.com/" title="WWW: http://cymplecy.wordpress.com/" class="btn btn-mini"><i class="icon icon-globe"></i></a></li>
				</ul>
			</dd>
		

		</dl>
	

	
	</div>


	<div id="p555773" class="post row-fluid even">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=11888&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">simplesi</a></strong> » Sun May 25, 2014 5:32 pm </div>

			

			<div class="content">I didn't have to 50ms wait before pulsing so I've added that into my own code to hopefuly reduce any false readings ta <img src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/icon_e_smile.gif" alt=":)" title="Smile"><br><br>Simon</div>

			<div id="sig555773" class="signature">Seeking help with Scratch and I/O stuff for Primary age children <br>http://cymplecy.wordpress.com/ @cymplecy on twitter</div>

		</div>

		
		<dl class="postprofile span3" id="profile555773">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 2327</dd><dd><strong>Joined:</strong> Fri Feb 24, 2012 6:19 pm</dd><dd><strong>Location:</strong> Euxton, Lancashire, UK</dd>
			<dd>
				<ul class="profile-icons">
					<li class="email-icon"><a href="http://cymplecy.wordpress.com/" title="WWW: http://cymplecy.wordpress.com/" class="btn btn-mini"><i class="icon icon-globe"></i></a></li>
				</ul>
			</dd>
		

		</dl>
	

	
	</div>


	<div id="p555836" class="post row-fluid odd">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105631&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">SavagePi</a></strong> » Sun May 25, 2014 7:57 pm </div>

			

			<div class="content">The manufacturers recommendation is not to 
re-sample until 64mS later.  But, since our programs are usually 
processing the data afterwards and doing other things in response to the
 results, 50mS using the (time.sleep) module is more than enough time 
before re-sampling.</div>

			<div id="sig555836" class="signature"><span style="color: #4040FF"><span style="font-size: 85%; line-height: 116%;">Electronics...  It's what I do!</span></span></div>

		</div>

		
		<dl class="postprofile span3" id="profile555836">
			<dt>
				<a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105631&amp;sid=ee50a51e0beefeb5b014bd86f88087bc"><img src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/file_002.php" alt="User avatar" width="88" height="85"></a><br>
				
			</dt>
		<dd><strong>Posts:</strong> 42</dd><dd><strong>Joined:</strong> Mon Mar 31, 2014 7:34 pm</dd><dd><strong>Location:</strong> Staffordshire, England</dd>

		</dl>
	

	
	</div>


	<div id="p588596" class="post row-fluid even">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=116188&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">nizam</a></strong> » Wed Jul 30, 2014 1:59 am </div>

			

			<div class="content">hi, <br>im a beginner i robotic and sensor.<br>im
 doing a research on robotic and ultrasonic sensor. When using a hc-sr04
 and connect to raspberry pi with 25ms time.sleep, my data seems not 
very stable. Is it ordinary case or it just an usual one?</div>

			

		</div>

		
		<dl class="postprofile span3" id="profile588596">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 15</dd><dd><strong>Joined:</strong> Wed Jul 30, 2014 1:52 am</dd>

		</dl>
	

	
	</div>


	<div id="p588670" class="post row-fluid odd">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=24295&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">joan</a></strong> » Wed Jul 30, 2014 6:53 am </div>

			

			<div class="content"><blockquote><div><cite>nizam wrote:</cite>hi, <br>im a beginner i robotic and sensor.<br>im
 doing a research on robotic and ultrasonic sensor. When using a hc-sr04
 and connect to raspberry pi with 25ms time.sleep, my data seems not 
very stable. Is it ordinary case or it just an usual one?</div></blockquote><br>It's probably best to start a new thread and explain your problem there.  The code you are using would also be helpful.</div>

			

		</div>

		
		<dl class="postprofile span3" id="profile588670">
			<dt>
				<a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=24295&amp;sid=ee50a51e0beefeb5b014bd86f88087bc"><img src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/file.php" alt="User avatar" width="90" height="90"></a><br>
				
			</dt>
		<dd><strong>Posts:</strong> 11726</dd><dd><strong>Joined:</strong> Thu Jul 05, 2012 5:09 pm</dd><dd><strong>Location:</strong> UK</dd>

		</dl>
	

	
	</div>


	<div id="p732993" class="post row-fluid even">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=142543&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">Adilkhan</a></strong> » Fri Apr 03, 2015 7:00 am </div>

			

			<div class="content">why doesnt work HC-SR04 Ultrasonic sensor with raspberry pi b2 ?Can anyone help me?</div>

			

		</div>

		
		<dl class="postprofile span3" id="profile732993">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 2</dd><dd><strong>Joined:</strong> Fri Apr 03, 2015 6:27 am</dd>

		</dl>
	

	
	</div>


	<div id="p733448" class="post row-fluid odd">
	
		<div class="postbody span9">
			

			<div class="author">by <strong><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=viewprofile&amp;u=105275&amp;sid=ee50a51e0beefeb5b014bd86f88087bc">BMS Doug</a></strong> » Fri Apr 03, 2015 5:52 pm </div>

			

			<div class="content">Many can help, if you provide enough 
information. The chances are that it is a wiring problem or a 
programming problem, if you provide details of both then someone will be
 able to help.<br><br>Probably best to have it in its own thread.</div>

			<div id="sig733448" class="signature">Doug.<br>Building Management Systems Engineer.</div>

		</div>

		
		<dl class="postprofile span3" id="profile733448">
			<dt>
				
			</dt>
		<dd><strong>Posts:</strong> 3589</dd><dd><strong>Joined:</strong> Thu Mar 27, 2014 2:42 pm</dd><dd><strong>Location:</strong> London, UK</dd>

		</dl>
	

	
	</div>


	<div class="span4 text-right">
		<form class="form-search" method="get" id="forum-search" action="./search.php?sid=ee50a51e0beefeb5b014bd86f88087bc">
		<fieldset>
			<input class="search-query" name="keywords" id="search_keywords" size="20" value="Search This Topic" onclick="if (this.value == 'Search This Topic') this.value = '';" onblur="if (this.value == '') this.value = 'Search This Topic';" type="text">
			<button class="btn" type="submit" value="Search"><i class="icon icon-search"></i></button>
			<input name="t" value="77534" type="hidden">
<input name="sf" value="msgonly" type="hidden">
<input name="sid" value="ee50a51e0beefeb5b014bd86f88087bc" type="hidden">

		</fieldset>
		</form>

	</div>	
	
	</div>
	

	<hr class="crease">
	<div class="container">

<div class="row-fluid">
	<div class="topic-actions span8">
	
		<a href="https://www.raspberrypi.org/forums/posting.php?mode=reply&amp;f=37&amp;t=77534&amp;sid=ee50a51e0beefeb5b014bd86f88087bc" class="btn btn-info" title="Post a reply">Post a reply</a> 
	&nbsp;</div>
	
	
	<div class="paging span4 text-right">
		14 posts
		
	</div>
	
	
</div>
<br>


<div class="row-fluid">
	<div class="span4">
		
		<a href="https://www.raspberrypi.org/forums/viewforum.php?f=37&amp;sid=ee50a51e0beefeb5b014bd86f88087bc" class="btn left" accesskey="r">Return to Automation, sensing and robotics</a>
		
	</div>
	<div class="span2">
		&nbsp;
	</div>
	<div class="span6 text-right">
		
		<form method="post" id="jumpbox" action="./viewforum.php?sid=ee50a51e0beefeb5b014bd86f88087bc" onsubmit="if(this.f.value == -1){return false;}" class="form-inline">

		
		<fieldset class="jumpbox">
		
		
			<label for="f" accesskey="j">Jump to: 
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="19">Community</option>
			
				<option value="63">&nbsp; &nbsp;General discussion</option>
			
				<option value="90">&nbsp; &nbsp;Other languages</option>
			
				<option value="75">&nbsp; &nbsp;&nbsp; &nbsp;Deutsch</option>
			
				<option value="76">&nbsp; &nbsp;&nbsp; &nbsp;Español</option>
			
				<option value="65">&nbsp; &nbsp;&nbsp; &nbsp;Français</option>
			
				<option value="79">&nbsp; &nbsp;&nbsp; &nbsp;Italiano</option>
			
				<option value="88">&nbsp; &nbsp;&nbsp; &nbsp;Nederlands</option>
			
				<option value="82">&nbsp; &nbsp;&nbsp; &nbsp;日本語</option>
			
				<option value="103">&nbsp; &nbsp;&nbsp; &nbsp;Polski</option>
			
				<option value="74">&nbsp; &nbsp;&nbsp; &nbsp;Português</option>
			
				<option value="84">&nbsp; &nbsp;&nbsp; &nbsp;Русский</option>
			
				<option value="89">&nbsp; &nbsp;&nbsp; &nbsp;Türkçe</option>
			
				<option value="57">&nbsp; &nbsp;User groups and events</option>
			
				<option value="106">&nbsp; &nbsp;The MagPi</option>
			
				<option value="83">&nbsp; &nbsp;The Pi Store</option>
			
				<option value="12">Using the Raspberry Pi</option>
			
				<option value="91">&nbsp; &nbsp;Beginners</option>
			
				<option value="28">&nbsp; &nbsp;Troubleshooting</option>
			
				<option value="29">&nbsp; &nbsp;Advanced users</option>
			
				<option value="102">&nbsp; &nbsp;Accessibility</option>
			
				<option value="17">Education</option>
			
				<option value="47">&nbsp; &nbsp;The Staffroom</option>
			
				<option value="99">&nbsp; &nbsp;Picademy</option>
			
				<option value="49">&nbsp; &nbsp;Teaching and learning resources</option>
			
				<option value="113">&nbsp; &nbsp;Code Club</option>
			
				<option value="48">&nbsp; &nbsp;Using Raspberry Pi in the classroom</option>
			
				<option value="104">&nbsp; &nbsp;Astro Pi</option>
			
				<option value="94">&nbsp; &nbsp;Mathematica</option>
			
				<option value="111">&nbsp; &nbsp;High Altitude Balloon</option>
			
				<option value="112">&nbsp; &nbsp;Weather station</option>
			
				<option value="14">Programming</option>
			
				<option value="72">&nbsp; &nbsp;Bare metal</option>
			
				<option value="33">&nbsp; &nbsp;C/C++</option>
			
				<option value="67">&nbsp; &nbsp;Graphics programming</option>
			
				<option value="68">&nbsp; &nbsp;&nbsp; &nbsp;OpenGLES</option>
			
				<option value="69">&nbsp; &nbsp;&nbsp; &nbsp;OpenVG</option>
			
				<option value="70">&nbsp; &nbsp;&nbsp; &nbsp;OpenMAX</option>
			
				<option value="81">&nbsp; &nbsp;Java</option>
			
				<option value="32">&nbsp; &nbsp;Python</option>
			
				<option value="77">&nbsp; &nbsp;Scratch</option>
			
				<option value="105">&nbsp; &nbsp;Windows 10 for IoT</option>
			
				<option value="95">&nbsp; &nbsp;Wolfram Language</option>
			
				<option value="34">&nbsp; &nbsp;Other languages</option>
			
				<option value="31">&nbsp; &nbsp;General programming discussion</option>
			
				<option value="15">Projects</option>
			
				<option value="37" selected="selected">&nbsp; &nbsp;Automation, sensing and robotics</option>
			
				<option value="40">&nbsp; &nbsp;Cases</option>
			
				<option value="78">&nbsp; &nbsp;Gaming</option>
			
				<option value="38">&nbsp; &nbsp;Graphics, sound and multimedia</option>
			
				<option value="39">&nbsp; &nbsp;Magazines and books</option>
			
				<option value="35">&nbsp; &nbsp;Media centres</option>
			
				<option value="36">&nbsp; &nbsp;Networking and servers</option>
			
				<option value="41">&nbsp; &nbsp;Other projects</option>
			
				<option value="16">Hardware and peripherals</option>
			
				<option value="43">&nbsp; &nbsp;Camera board</option>
			
				<option value="98">&nbsp; &nbsp;Compute Module</option>
			
				<option value="108">&nbsp; &nbsp;Official Foundation Display</option>
			
				<option value="45">&nbsp; &nbsp;Add-ons</option>
			
				<option value="100">&nbsp; &nbsp;B+ addons</option>
			
				<option value="107">&nbsp; &nbsp;Device Tree</option>
			
				<option value="44">&nbsp; &nbsp;Interfacing (DSI, CSI, I2C, etc.)</option>
			
				<option value="42">&nbsp; &nbsp;Gertboard classic</option>
			
				<option value="96">&nbsp; &nbsp;GertDuino</option>
			
				<option value="46">&nbsp; &nbsp;Recommended peripherals</option>
			
				<option value="18">Operating system distributions</option>
			
				<option value="66">&nbsp; &nbsp;Raspbian</option>
			
				<option value="53">&nbsp; &nbsp;Arch</option>
			
				<option value="51">&nbsp; &nbsp;Pidora / Fedora</option>
			
				<option value="55">&nbsp; &nbsp;RISCOS</option>
			
				<option value="56">&nbsp; &nbsp;Other</option>
			
				<option value="73">&nbsp; &nbsp;&nbsp; &nbsp;Android</option>
			
				<option value="50">&nbsp; &nbsp;&nbsp; &nbsp;Debian</option>
			
				<option value="85">&nbsp; &nbsp;&nbsp; &nbsp;FreeBSD</option>
			
				<option value="54">&nbsp; &nbsp;&nbsp; &nbsp;Gentoo</option>
			
				<option value="71">&nbsp; &nbsp;&nbsp; &nbsp;Linux Kernel</option>
			
				<option value="86">&nbsp; &nbsp;&nbsp; &nbsp;NetBSD</option>
			
				<option value="87">&nbsp; &nbsp;&nbsp; &nbsp;openSUSE</option>
			
				<option value="80">&nbsp; &nbsp;&nbsp; &nbsp;Plan 9</option>
			
				<option value="52">&nbsp; &nbsp;&nbsp; &nbsp;Puppy</option>
			
				<option value="20">Ye Olde Pi Shoppe</option>
			
				<option value="93">&nbsp; &nbsp;For sale</option>
			
				<option value="61">&nbsp; &nbsp;Wanted</option>
			
				<option value="21">Off topic</option>
			
				<option value="62">&nbsp; &nbsp;Off topic discussion</option>
			
			
			</select>
			<input value="Go" class="btn" type="submit">
			</label>
		</fieldset>
		
		</form>
		
	</div>
</div>

</div>
<hr class="crease">
<div class="container">

<div class="row-fluid">
	<div class="span8">
		
		<h5>Who is online</h5>
		Users browsing this forum: No registered users and 31 guests
		
	</div>
	<div class="span4">
	&nbsp;
	</div>
</div>

</div><!-- #main -->

<footer id="colophon" role="contentinfo" class="wave">
		<div class="container"><div class="row">
			<aside class="footer1 span4">
				<ul class="unstyled">
					<li><a href="https://www.raspberrypi.org/forums/index.php?sid=ee50a51e0beefeb5b014bd86f88087bc" accesskey="h"><i class="icon icon-home"></i> Board index</a></li>
					
					
					
					<li><a href="https://www.raspberrypi.org/forums/memberlist.php?mode=leaders&amp;sid=ee50a51e0beefeb5b014bd86f88087bc"><i class="icon icon-eye-open"></i> The team</a></li><li><a href="https://www.raspberrypi.org/forums/ucp.php?mode=delete_cookies&amp;sid=ee50a51e0beefeb5b014bd86f88087bc"><i class="icon icon-trash"></i> Delete all board cookies</a></li>
					
					<li><i class="icon icon-time"></i> All times are UTC </li>
				</ul>
			</aside>
				
			<aside class="footer2 span4">
				
			</aside>
				
			<aside class="footer3 span4">
				
			</aside>
	
		</div></div>
	</footer><!-- #colophon -->
<!-- #page -->


<script type="text/javascript" src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/jquery.js"></script>
<script type="text/javascript" src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/jquery_002.js"></script>
<script type="text/javascript" src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/forum_fn.js"></script>
<script type="text/javascript" src="Raspberry%20Pi%20%E2%80%A2%20View%20topic%20-%20Problems%20with%20the%20HC-SR04%20Ultrasonic%20Sensor_files/bootstrap.js"></script>
<script type="text/javascript">
jQuery(document).ready(function() {

	jQuery("time.entry-date").timeago();
	jQuery("time.date").timeago();
  
	jQuery('iframe').each( function() {
		var url = jQuery(this).attr("src")
		jQuery(this).attr("src",url+"&wmode=transparent")
	});

});
</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46270871-1', 'raspberrypi.org');
  ga('send', 'pageview');

</script>
	

</body></html>